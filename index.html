<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Partner-Caregiver Interpretation Task</title>
    <!-- cache-bust so mobile won’t use stale CSS -->
    <link rel="stylesheet" href="./styles.css?v=10" />
  </head>

  <body>
    <!-- ===== Instructions Screen ===== -->
    <section id="screen-instructions" class="screen show" role="region" aria-labelledby="inst-title">
      <div class="inst-card">
        <header class="inst-header">
          <h1 id="inst-title">Partner-Caregiver Interpretation Assessment</h1>
          <p class="subtitle">Please read before you begin</p>
        </header>

        <div class="inst-content">
          <ol class="inst-list">
            <li>
              <strong>Eligibility</strong><br />
              This task is intended for married partners who have been married (and living together) for
              <span class="editable" data-key="minYears">at least two years</span>. Results may not be valid otherwise.
            </li>
            <li>
              <strong>How the task works</strong><br />
              You’ll read short, four-line scenarios. Each is intentionally ambiguous and can be understood in different ways.
              Choose the option that feels closest to your thoughts. <em>There are no right or wrong answers.</em>
            </li>
            <li>
              <strong>Practice (not recorded)</strong><br />
              Before the main block, you’ll do <span class="editable" data-key="nPractice">two</span> neutral, not-health-related
              scenarios to get familiar with the task. Your responses to these practice items <em>are not recorded</em>.
            </li>
            <li>
              <strong>Privacy</strong><br />
              Your responses are handled confidentially and analyzed in aggregate. Individual data are not shared outside the research team.
            </li>
          </ol>

          <details class="inst-details">
            <summary>Copyright &amp; Use</summary>
            <p class="smallprint">
              This task was <strong>designed, developed, and tested by Pouyan Alizadeh and Ali Khatibi</strong>.
              All rights reserved. Any use, reproduction, or distribution requires prior <strong>written consent</strong>
              from the authors.
            </p>
          </details>
        </div>

        <footer class="inst-footer">
          <button id="btn-begin" class="primary">I’m ready to begin</button>
          <p class="footnote smallprint">
            By continuing, you confirm you have read and meet the eligibility criteria.
          </p>
        </footer>
      </div>
    </section>

    <!-- ===== Task Screen ===== -->
    <section id="screen-task" class="screen hidden">
      <div id="fixation" class="fixation" style="display:none">+</div>

      <div class="task-wrap">
        <!-- Scenario -->
        <div id="scenario" class="scenario">
          <div id="line1" class="line"></div>
          <div id="line2" class="line"></div>
          <div id="line3" class="line"></div>
          <div id="line4" class="line strong"></div>
        </div>

        <!-- Answers -->
        <div id="answers" class="answers" style="display:none">
          <button id="opt1" class="answer-btn" data-index="0"></button>
          <button id="opt2" class="answer-btn" data-index="1"></button>
        </div>
      </div>

      <!-- Confidence modal -->
      <div id="confidence" class="confidence hidden">
        <div class="conf-wrap">
          <div class="conf-title">How confident are you?</div>
          <div class="conf-grid">
            <button class="conf" data-val="1">1</button>
            <button class="conf" data-val="2">2</button>
            <button class="conf" data-val="3">3</button>
            <button class="conf" data-val="4">4</button>
            <button class="conf" data-val="5">5</button>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== Results Screen ===== -->
    <section id="screen-results" class="screen hidden">
      <div class="card">
        <h2>Results</h2>
        <p id="metaLine" class="muted"></p>

        <div class="row">
          <div class="done-card" style="flex:1">
            <strong>Summary</strong>
            <div>N trials: <span id="m_n">0</span></div>
            <div>Benign choices: <span id="m_benign">0</span> (<span id="m_prop_benign">0%</span>)</div>
            <div>Threat choices: <span id="m_threat">0</span> (<span id="m_prop_threat">0%</span>)</div>
            <div>RT (ms) benign: <span id="m_rt_b_m">0</span> ± <span id="m_rt_b_sd">0</span></div>
            <div>RT (ms) threat: <span id="m_rt_t_m">0</span> ± <span id="m_rt_t_sd">0</span></div>
            <div>Confidence benign / threat: <span id="m_conf_b_m">0</span> / <span id="m_conf_t_m">0</span></div>
            <div>Pattern: <span id="m_pattern">—</span></div>
          </div>
        </div>

        <h3>APA-style note</h3>
        <pre id="apaText" class="apa"></pre>

        <div class="row">
          <button id="dlCsv" class="secondary">Download CSV</button>
          <button id="dlJson" class="secondary">Download JSON</button>
          <button id="copyApa" class="secondary">Copy APA text</button>
          <button id="again" class="primary">Run Again</button>
        </div>
      </div>
    </section>

    <!-- Load data then app -->
    <script src="./scenarios.js?v=4"></script>
    <script src="./app.js?v=6"></script>
  </body>
</html>
